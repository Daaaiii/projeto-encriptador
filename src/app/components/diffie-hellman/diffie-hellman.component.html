<div class="container">
      <div class="main-card">
        <div class="header">
          <h2>üîê Protocolo Diffie-Hellman - Segunda Parte da Fase 1</h2>
        </div>

        <div class="content">
          <!-- Valores Iniciais -->
          <div class="section">
            <h3 class="section-title">‚ÑπÔ∏è Valores Fornecidos</h3>
            <div class="values-table">
              <div class="table-row">
                <div class="table-cell-label">Primo p:</div>
                <div class="table-cell-value monospace">{{ values.p }}</div>
              </div>
              <div class="table-row">
                <div class="table-cell-label">Gerador g:</div>
                <div class="table-cell-value monospace">{{ values.g }}</div>
              </div>
              <div class="table-row">
                <div class="table-cell-label">Valor A (Alice):</div>
                <div class="table-cell-value monospace">{{ values.A }}</div>
              </div>
              <div class="table-row">
                <div class="table-cell-label">Valor b (privado):</div>
                <div class="table-cell-value monospace">{{ values.b }}</div>
              </div>
              <div class="table-row">
                <div class="table-cell-label">D√≠gitos de b:</div>
                <div class="table-cell-value">
                  <span class="badge success">{{ values.b.length }} d√≠gitos</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Status Loading -->
          <div class="section" *ngIf="loading">
            <div class="loading-container">
              <div class="spinner"></div>
              <p>Calculando valores... Por favor, aguarde.</p>
            </div>
          </div>

          <!-- Tarefa 2.1 -->
          <div class="section" *ngIf="!loading && results">
            <div class="task-card info">
              <h3 class="task-title">üßÆ Tarefa 2.1: C√°lculo do Valor B</h3>

              <div class="task-content">
                <div class="formula-section">
                  <h4>F√≥rmula:</h4>
                  <div class="formula-box">
                    B = g<sup>b</sup> mod p = {{ values.g }}<sup>{{ formatNumber(values.b, 20) }}...</sup> mod {{ formatNumber(values.p, 20) }}...
                  </div>
                </div>

                <div class="result-section">
                  <h4>Resultado:</h4>
                  <div class="result-box success">
                    <strong>B = </strong><span class="monospace">{{ results.B }}</span>
                  </div>
                </div>

                <div class="steps-section">
                  <h4>Passos do C√°lculo:</h4>
                  <ol class="steps-list">
                    <li>Utilizar exponencia√ß√£o modular eficiente: pow(g, b, p)</li>
                    <li>Calcular 10<sup>b</sup> mod p usando aritm√©tica modular</li>
                    <li>O resultado B √© o valor p√∫blico a ser enviado para Alice</li>
                  </ol>
                </div>
              </div>
            </div>
          </div>

          <!-- Tarefa 2.2 -->
          <div class="section" *ngIf="!loading && results">
            <div class="task-card warning">
              <h3 class="task-title">üîÑ Tarefa 2.2: C√°lculo do Valor v (Chave Compartilhada)</h3>

              <div class="task-content">
                <div class="formula-section">
                  <h4>F√≥rmula:</h4>
                  <div class="formula-box">
                    v = A<sup>b</sup> mod p = {{ formatNumber(values.A, 20) }}...<sup>{{ formatNumber(values.b, 20) }}...</sup> mod {{ formatNumber(values.p, 20) }}...
                  </div>
                </div>

                <div class="result-section">
                  <h4>Resultado:</h4>
                  <div class="result-box warning">
                    <strong>v = </strong><span class="monospace">{{ results.v }}</span>
                  </div>
                </div>

                <div class="steps-section">
                  <h4>Passos do C√°lculo:</h4>
                  <ol class="steps-list">
                    <li>Utilizar exponencia√ß√£o modular: pow(A, b, p)</li>
                    <li>Elevar A (valor de Alice) √† pot√™ncia b (valor privado) m√≥dulo p</li>
                    <li>O valor v representa a chave compartilhada antes do hash</li>
                  </ol>
                </div>
              </div>
            </div>
          </div>

          <!-- Tarefa 2.3 -->
          <div class="section" *ngIf="!loading && results">
            <div class="task-card success">
              <h3 class="task-title">üõ°Ô∏è Tarefa 2.3: Gera√ß√£o da Chave k (SHA256)</h3>

              <div class="task-content">
                <div class="formula-section">
                  <h4>Processo:</h4>
                  <div class="process-box">
                    <div><strong>Entrada:</strong> v = {{ results.v }}</div>
                    <div><strong>SHA256:</strong> {{ results.sha256_full }}</div>
                    <div><strong>Primeiros 128 bits:</strong> {{ results.k }} (32 chars hex)</div>
                  </div>
                </div>

                <div class="result-section">
                  <h4>Chave Final:</h4>
                  <div class="key-result">
                    <div class="key-icon">üîë</div>
                    <div class="key-value">k = {{ results.k }}</div>
                  </div>
                </div>

                <div class="steps-section">
                  <h4>Passos do C√°lculo:</h4>
                  <ol class="steps-list">
                    <li>Converter valor v para string decimal</li>
                    <li>Aplicar fun√ß√£o SHA256 na string</li>
                    <li>Extrair primeiros 128 bits (32 caracteres hexadecimais)</li>
                    <li>Esta chave k ser√° usada para criptografia</li>
                  </ol>
                </div>
              </div>
            </div>
          </div>

          <!-- Resumo Final -->
          <div class="section" *ngIf="!loading && results">
            <div class="summary-card">
              <div class="summary-header">
                <h3>üìã Resumo dos Resultados</h3>
              </div>
              <div class="summary-content">
                <div class="summary-table">
                  <div class="summary-row muted">
                    <div class="summary-label">b (valor privado):</div>
                    <div class="summary-value monospace">{{ values.b }}</div>
                  </div>
                  <div class="summary-row info">
                    <div class="summary-label">B (valor p√∫blico a enviar):</div>
                    <div class="summary-value monospace">{{ results.B }}</div>
                  </div>
                  <div class="summary-row warning">
                    <div class="summary-label">v (chave compartilhada):</div>
                    <div class="summary-value monospace">{{ results.v }}</div>
                  </div>
                  <div class="summary-row success">
                    <div class="summary-label">k (chave de 128 bits):</div>
                    <div class="summary-value monospace large">{{ results.k }}</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Bot√µes de A√ß√£o -->
          <div class="section" *ngIf="!loading && results">
            <div class="actions">
              <button class="btn primary" (click)="exportResults()">
                üì• Exportar Resultados
              </button>
              <button class="btn secondary" (click)="copyToClipboard()">
                üìã Copiar Chave k
              </button>
              <button class="btn outline" (click)="recalculate()">
                üîÑ Recalcular
              </button>
            </div>
          </div>

          <!-- Erro -->
          <div class="section" *ngIf="error">
            <div class="error-card">
              <h4>‚ùå Erro:</h4>
              <p>{{ error }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
